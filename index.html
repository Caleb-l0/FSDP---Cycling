<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HappyVolunteer</title>
  <!-- Load CSS from root folder -->
  <link rel="stylesheet" href="index.css">
</head>
<body>

  <!-- Load header dynamically -->
  <div id="header-placeholder"></div>

  <!-- Hero Slider -->
  <section class="hero">
    <div class="hero-slider">
      <div class="slide active" style="background-image: url('images/img4.jpg');">
        <div class="hero-content">
          <h1>Welcome to HappyVolunteer</h1>
          <p>Empowering communities through compassion and collaboration.</p>
        </div>
      </div>
      <div class="slide" style="background-image: url('images/IMG3.webp');">
        <div class="hero-content">
          <h1>Make a Difference Today</h1>
          <p>Join us in creating meaningful change across communities.</p>
        </div>
      </div>
      <div class="slide" style="background-image: url('images/img5.jpg');">
        <div class="hero-content">
          <h1>Together We Grow Stronger</h1>
          <p>Be part of a movement that inspires hope and unity.</p>
        </div>
      </div>
    </div>

    <div class="slider-dots">
      <span class="dot active"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    </div>
  </section>

  <!-- Info Section -->
  <section class="info-section">
    <div class="container">
      <h2>Why Join HappyVolunteer?</h2>
      <div class="info-grid">
        <div class="card">
          <h3>üå± Grow Your Skills</h3>
          <p>Gain real-world experience and leadership skills by helping others.</p>
        </div>
        <div class="card">
          <h3>üíõ Give Back</h3>
          <p>Contribute to causes that make a real impact in your community.</p>
        </div>
        <div class="card">
          <h3>üåç Connect</h3>
          <p>Meet like-minded individuals who share your passion for service.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Login Modal -->
  <div id="loginModal" class="modal">
    <span class="close-btn" onclick="closeLogin()">&times;</span>
    <div class="modal-content">
      <h2>Login</h2>
      <form onsubmit="login(event)">
        <input type="email" id="email" placeholder="Email" required><br>
        <input type="password" id="password" placeholder="Password" required><br>
        <button type="submit">Login</button>
      </form>
      <p style="margin-top:10px;">
        Don't have an account? <a href="#" onclick="switchToSignup()">Sign Up</a>
      </p>
    </div>
  </div>

  <!-- Signup Modal -->
  <div id="signupModal" class="modal">
    <span class="close-btn" onclick="closeSignup()">&times;</span>
    <div class="modal-content">
      <h2>Sign Up</h2>
      <form onsubmit="signup(event)">
        <input type="text" id="signup-name" placeholder="Name" required><br>
        <input type="email" id="signup-email" placeholder="Email" required><br>
        <input type="password" id="signup-password" placeholder="Password" required><br>
        <div class="input-field">
          <label for="role">Role</label>
          <select id="role" required>
            <option value="">Select Role</option>
            <option value="admin">Admin</option>
            <option value="institution">Institution</option>
            <option value="volunteer">Volunteer</option>
          </select>
        </div>
        <button type="submit">Sign Up</button>
      </form>
      <p style="margin-top:10px;">
        Already have an account? <a href="#" onclick="switchToLogin()">Login</a>
      </p>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container footer-content">
      <div>
        <h3>HappyVolunteer</h3>
        <p>Inspiring change, one act of kindness at a time.</p>
      </div>
      <div>
        <h3>Quick Links</h3>
        <ul>
          <li><a href="#">About</a></li>
          <li><a href="#">Events</a></li>
          <li><a href="#">Join Us</a></li>
        </ul>
      </div>
      <div>
        <h3>Contact</h3>
        <p>Email: hello@happyvolunteer.org</p>
        <p>Phone: +65 9876 5432</p>
      </div>
    </div>
    <p>¬© 2025 HappyVolunteer. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    // Load header from public folder
    fetch('/public/header.html')
      .then(res => res.text())
      .then(data => document.getElementById('header-placeholder').innerHTML = data);

    // Hero slider
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.dot');

    function showSlide(index) {
      slides.forEach((s, i) => {
        s.classList.toggle('active', i === index);
        dots[i].classList.toggle('active', i === index);
      });
    }
    function nextSlide() {
      currentSlide = (currentSlide + 1) % slides.length;
      showSlide(currentSlide);
    }
    dots.forEach((dot, i) => {
      dot.addEventListener('click', () => {
        currentSlide = i;
        showSlide(i);
      });
    });
    setInterval(nextSlide, 5000);

    // Modals
    function openLogin() { document.getElementById('loginModal').classList.add('active'); }
    function closeLogin() { document.getElementById('loginModal').classList.remove('active'); }
    function openSignup() { document.getElementById('signupModal').classList.add('active'); }
    function closeSignup() { document.getElementById('signupModal').classList.remove('active'); }
    function switchToSignup() { closeLogin(); openSignup(); }
    function switchToLogin() { closeSignup(); openLogin(); }

    // Signup
    async function signup(event) {
      event.preventDefault();
      const name = document.getElementById('signup-name').value;
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;
      const role = document.getElementById('role').value;
      try {
        const res = await fetch('http://localhost:3000/signup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, email, password, role })
        });
        const data = await res.json();
        if (!res.ok) { alert(data.message || 'Signup failed'); return; }
        alert('üéâ Account created successfully!');
        closeSignup();
      } catch (err) {
        console.error(err);
        alert('‚ùå Error connecting to server');
      }
    }

    // Login
    async function login(event) {
      event.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        const res = await fetch('http://localhost:3000/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });
        const data = await res.json();
        if (!res.ok) { alert(data.message || 'Login failed'); return; }
        alert('‚úÖ Login successful!');
        localStorage.setItem("token", data.token);
        localStorage.setItem("userId", data.userId);
        localStorage.setItem("name", data.name);
        localStorage.setItem("email", data.email);
        localStorage.setItem("role", data.role);

        switch(data.role) {
          case 'admin': setTimeout(() => (window.location.href = '/public/homepage_login_Admin.html'), 1000); break;
          case 'volunteer': setTimeout(() => (window.location.href = '/public/homepage_login_volunteer.html'), 1000); break;
          case 'institution': setTimeout(() => (window.location.href = '/public/homepage_login_instituition.html'), 1000); break;
        }
      } catch (err) {
        console.error(err);
        alert('‚ùå Error connecting to server');
      }
    }
  </script>
</body>
</html>
